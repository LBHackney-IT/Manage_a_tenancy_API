version: "3"
services:
    manage-a-tenancy-api:
        image: manage-a-tenancy-api
        build:
            context: .
            dockerfile: ./Dockerfile
        ports:
            - "8080:80"
        links:
            - tm-process-db
        environment:
            - ApiConfiguration__TMProcessDataConnectionString=Server=localhost,1433;Database=TMProcess;MultipleActiveResultSets=true;User ID=sa;Password=Rooty-Tooty"
    tm-process-db:
        image: 775052747630.dkr.ecr.eu-west-2.amazonaws.com/hackney/apps/tm-process-db:mssql-2017-loaded
        ports:
            - "1433:1433"
    manage-a-tenancy-api-test:
        image: tm-process-api-test
        build:
            context: .
            dockerfile: ./ManageATenancyAPI.Tests/Dockerfile
        environment:
            - ApiConfiguration__TMProcessDataConnectionString=Server=localhost,1433;Database=TMProcess;MultipleActiveResultSets=true;User ID=sa;Password=Rooty-Tooty"
        links:
            - tm-process-db